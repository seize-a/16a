<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>16A</title>
  <link rel="manifest" href="/16a/manifest.json">
  <meta name="theme-color" content="#0b8b8b">
  <link rel="apple-touch-icon" href="/16a/icon-192x192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <style>
    body{font-family:system-ui; padding:2rem; color:#222}
    #installPopup{display:none; position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); background:#fff; padding:18px; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,.25); z-index:1000}
    #overlay{display:none; position:fixed; inset:0; background:rgba(0,0,0,.45); z-index:900}
    button{background:#0b8b8b; color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer}
    .muted{color:#666}
  </style>
</head>
<body>
  <h1>16A</h1>
  <p class="muted">Ouvre cette page depuis ton mobile pour tester l'installation.</p>

  <div id="overlay"></div>
  <div id="installPopup" role="dialog" aria-modal="true">
    <p>ðŸ“± Ajouter <strong>16A</strong> Ã  votre Ã©cran d'accueil ?</p>
    <div style="display:flex; gap:8px; justify-content:center">
      <button id="installBtn">Oui, installer</button>
      <button id="cancelBtn" style="background:#ccc; color:#111">Non</button>
    </div>
  </div>
  <div id="manualInstructions" style="display:none; margin-top:1rem;">
    <h3>Installation (iOS)</h3>
    <ol>
      <li>Tapez sur le bouton <strong>Partager</strong> dans Safari.</li>
      <li>SÃ©lectionnez <strong>Ajouter Ã  l'Ã©cran d'accueil</strong>.</li>
      <li>Confirmez.</li>
    </ol>
  </div>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/16a/service-worker.js')
    .then(()=>console.log('SW enregistrÃ©'))
    .catch(e=>console.warn('Erreur SW', e));
}

let deferredPrompt;
const overlay=document.getElementById('overlay');
const popup=document.getElementById('installPopup');
const installBtn=document.getElementById('installBtn');
const cancelBtn=document.getElementById('cancelBtn');
const manualInstructions=document.getElementById('manualInstructions');

window.addEventListener('beforeinstallprompt',(e)=>{
  e.preventDefault();
  deferredPrompt=e;
  overlay.style.display='block';
  popup.style.display='block';
});

installBtn.addEventListener('click',async()=>{
  if(!deferredPrompt)return;
  popup.style.display='none';
  overlay.style.display='none';
  deferredPrompt.prompt();
  await deferredPrompt.userChoice;
  deferredPrompt=null;
});

cancelBtn.addEventListener('click',()=>{
  popup.style.display='none';
  overlay.style.display='none';
});

function isIos(){return /iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase());}
function isInStandaloneMode(){return('standalone'in window.navigator)&&window.navigator.standalone;}
if(isIos()&&!isInStandaloneMode()){manualInstructions.style.display='block';}
</script>
</body>
</html>
